# ppk-nrf91
Nordic Semiconductor's Power Profiler Kit (PPK) is very useful for measuring and optimizing power consumption when developing battery-powered devices. We wanted to find a way to use this usefull tool also with nRF91 DK: the example of configuration where we have PPK working with onboard regulator and providing power supply for external DUT (NRF91 DK). At the same time NRF91 is working with AT command firmware and LTE link monitor


There are several ways to measure current on the nRF91 development kit (nRF91-DK) using various test equipment like Power analyzer, Oscilloscope, and Ampere-meter. All of them use the same connector with some external hardware and that is quite well explained in the Nordic documentation section ["Measuring current" of the nRF9160][currnet_mes]. Because we want to use Nordic Power Profiling Kit (nRF-PPK) with nRF91-DK we need to think of it as an external power supply case form the Nordic nRF91-DK documentation. 
The picture below shows the connection between nRF-PPK and nRF91-DK.

![alt text](https://github.com/IRNAS/ppk-nrf91/blob/master/pics/board_connection.jpg)
<p align="center">
  image 1: board connection</center>
</p>

From the image above we can see that one USB is connected to the nRF91-DK which is providing power for the on-board J-link and communication with the PC. Gray 10-pin cable is connecting J-link to the PPK on board nRF MCU. 

Second micro USB that is connected to the nRF-PPK is just providing input power to for the testing and for this to be enabled SW4 (Power select sw) need to be in the **Reg.** position. There is also a possibility to provide a regulated power supply externally to the P22 connector, but we chose the first solution because of additional features that will be explained later on. To provide power for the nRF91-DK we use External DUT (Design under test) option and connect P16 of nRF-PPK to the P24 of nRF91-DK. It is important to pay attention to the positive and negative pins and connect them correctly as in the picture and for this to work SB43 need to be cut. In the nRF-PPK SW2 (DUT select) need to be in the **External** position. 

When everything is connected [nRF Connect for desktop software][nrf_connect_desktop] can be used to test the setup. Before connecting the nRF-PPK to the nRF91-DK we flashed the module with the [AT command firmware][nrf_connect_atfw] for testing porpuses. After that, on desktop, we start two applications **Power profiler** and **LTE Link monitor**. We use the LTE Link monitor app to put the nRF91 module in different states and see the power results with the PPK. The picture below shows the connection testing of the CAT-M connection try. NB-IoT is not yet tested. 


![alt text](https://github.com/IRNAS/ppk-nrf91/blob/master/pics/image_apps.png)
<p align="center">
  image 2: apps</center>
</p>

Using on-board power regulator is a good option because there is an option in the software to change the power voltage of the DUT system. 

## Setup tools:
* PC with Windows OS (probably possible on thher OS but not tested)
* nRF-PPK
* nRF91-DK
* 2x micro USB cables
* 10 pin flat cable (50 mil pich)
* 2x jumper wires


## License

All our projects are as usefully open-source as possible.

Hardware including documentation is licensed under [CERN OHL v.1.2. license](http://www.ohwr.org/licenses/cern-ohl/v1.2)

Firmware and software originating from the project is licensed under [GNU GENERAL PUBLIC LICENSE v3](http://www.gnu.org/licenses/gpl-3.0.en.html).

Open data generated by our projects is licensed under [CC0](https://creativecommons.org/publicdomain/zero/1.0/legalcode).

All our websites and additional documentation are licensed under [Creative Commons Attribution-ShareAlike 4 .0 Unported License] (https://creativecommons.org/licenses/by-sa/4.0/legalcode).

What this means is that you can use hardware, firmware, software and documentation without paying a royalty and knowing that you'll be able to use your version forever. You are also free to make changes but if you share these changes then you have to do so on the same conditions that you enjoy.

Koruza, GoodEnoughCNC and IRNAS are all names and marks of Institut IRNAS Raƒçe. 
You may use these names and terms only to attribute the appropriate entity as required by the Open Licences referred to above. You may not use them in any other way and in particular you may not use them to imply endorsement or authorization of any hardware that you design, make or sell.


[currnet_mes]: https://infocenter.nordicsemi.com/index.jsp?topic=%2Fug_ppk%2FUG%2Fppk%2FPPK_user_guide_Configuring_the_PPK.html&cp=6_6_5
[nrf_connect_desktop]: https://www.nordicsemi.com/Software-and-Tools/Development-Tools/nRF-Connect-for-desktop
[nrf_connect_atfw]: https://github.com/NordicPlayground/fw-nrfconnect-nrf/tree/master/samples/nrf9160/serial_lte_modem
